/** vim: et:ts=4:sw=4:sts=4
 * @license RequireJS 1.0.5 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/requirejs for details
 */

/*
 * Copyright (c) Novedia Group 2012.
 *
 *     This file is part of Hubiquitus.
 *
 *     Hubiquitus is free software: you can redistribute it and/or modify
 *     it under the terms of the GNU General Public License as published by
 *     the Free Software Foundation, either version 3 of the License, or
 *     (at your option) any later version.
 *
 *     Hubiquitus is distributed in the hope that it will be useful,
 *     but WITHOUT ANY WARRANTY; without even the implied warranty of
 *     MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *     GNU General Public License for more details.
 *
 *     You should have received a copy of the GNU General Public License
 *     along with Hubiquitus.  If not, see <http://www.gnu.org/licenses/>.
 */

/*! Socket.IO.js build:0.9.10, development. Copyright(c) 2011 LearnBoost <dev@learnboost.com> MIT Licensed */

/**
     * socket.io
     * Copyright(c) 2011 LearnBoost <dev@learnboost.com>
     * MIT Licensed
     */

/**
         * Parses an URI
         *
         * @author Steven Levithan <stevenlevithan.com> (MIT license)
         * @api public
         */

function UUID(){}var requirejs,require,define;(function(){function isFunction(e){return ostring.call(e)==="[object Function]"}function isArray(e){return ostring.call(e)==="[object Array]"}function mixin(e,t,n){for(var r in t)!(r in empty)&&(!(r in e)||n)&&(e[r]=t[r]);return req}function makeError(e,t,n){var r=new Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e);return n&&(r.originalError=n),r}function configurePackageDir(e,t,n){var r,i,s;for(r=0;s=t[r];r++)s=typeof s=="string"?{name:s}:s,i=s.location,n&&(!i||i.indexOf("/")!==0&&i.indexOf(":")===-1)&&(i=n+"/"+(i||s.name)),e[s.name]={name:s.name,location:i||s.name,main:(s.main||"main").replace(currDirRegExp,"").replace(jsSuffixRegExp,"")}}function jQueryHoldReady(e,t){e.holdReady?e.holdReady(t):t?e.readyWait+=1:e.ready(!0)}function newContext(e){function y(e){var t,n;for(t=0;n=e[t];t++)if(n===".")e.splice(t,1),t-=1;else if(n===".."){if(t===1&&(e[2]===".."||e[0]===".."))break;t>0&&(e.splice(t-1,2),t-=2)}}function b(e,t){var n,i;return e&&e.charAt(0)==="."&&(t?(r.pkgs[t]?t=[t]:(t=t.split("/"),t=t.slice(0,t.length-1)),e=t.concat(e.split("/")),y(e),i=r.pkgs[n=e[0]],e=e.join("/"),i&&e===n+"/"+i.main&&(e=n)):e.indexOf("./")===0&&(e=e.substring(2))),e}function w(e,n){var r=e?e.indexOf("!"):-1,i=null,s=n?n.name:null,a=e,f,l,c;return r!==-1&&(i=e.substring(0,r),e=e.substring(r+1,e.length)),i&&(i=b(i,s)),e&&(i?(c=u[i],c&&c.normalize?f=c.normalize(e,function(e){return b(e,s)}):f=b(e,s)):(f=b(e,s),l=o[f],l||(l=t.nameToUrl(e,null,n),o[f]=l))),{prefix:i,name:f,parentMap:n,url:l,originalName:a,fullName:i?i+"!"+(f||""):f}}function E(){var e=!0,t=r.priorityWait,n,i;if(t){for(i=0;n=t[i];i++)if(!a[n]){e=!1;break}e&&delete r.priorityWait}return e}function S(e,t,n){return function(){var r=aps.call(arguments,0),i;return n&&isFunction(i=r[r.length-1])&&(i.__requireJsBuild=!0),r.push(t),e.apply(null,r)}}function x(e,n,r){var i=S(r||t.require,e,n);return mixin(i,{nameToUrl:S(t.nameToUrl,e),toUrl:S(t.toUrl,e),defined:S(t.requireDefined,e),specified:S(t.requireSpecified,e),isBrowser:req.isBrowser}),i}function T(e){t.paused.push(e)}function N(e){var n,i,s,o,a,c=e.callback,h=e.map,d=h.fullName,g=e.deps,y=e.listeners,b;if(c&&isFunction(c)){if(r.catchError.define)try{i=req.execCb(d,e.callback,g,u[d])}catch(E){s=E}else i=req.execCb(d,e.callback,g,u[d]);d&&(b=e.cjsModule,b&&b.exports!==undefined&&b.exports!==u[d]?i=u[d]=e.cjsModule.exports:i===undefined&&e.usingExports?i=u[d]:(u[d]=i,v[d]&&(m[d]=!0)))}else d&&(i=u[d]=c,v[d]&&(m[d]=!0));f[e.id]&&(delete f[e.id],e.isDone=!0,t.waitCount-=1,t.waitCount===0&&(l=[])),delete p[d],req.onResourceLoad&&!e.placeholder&&req.onResourceLoad(t,h,e.depArray);if(s)return o=(d?w(d).url:"")||s.fileName||s.sourceURL,a=s.moduleTree,s=makeError("defineerror",'Error evaluating module "'+d+'" at location "'+o+'":\n'+s+"\nfileName:"+o+"\nlineNumber: "+(s.lineNumber||s.line),s),s.moduleName=d,s.moduleTree=a,req.onError(s);for(n=0;c=y[n];n++)c(i);return undefined}function C(e,t){return function(n){e.depDone[t]||(e.depDone[t]=!0,e.deps[t]=n,e.depCount-=1,e.depCount||N(e))}}function k(e,i){var s=i.map,o=s.fullName,f=s.name,l=d[e]||(d[e]=u[e]),c;if(i.loading)return;i.loading=!0,c=function(e){i.callback=function(){return e},N(i),a[i.id]=!0,n()},c.fromText=function(e,n){var r=useInteractive;a[e]=!1,t.scriptCount+=1,t.fake[e]=!0,r&&(useInteractive=!1),req.exec(n),r&&(useInteractive=!0),t.completeLoad(e)},o in u?c(u[o]):l.load(f,x(s.parentMap,!0,function(e,n){var r=[],o,u,a;for(o=0;u=e[o];o++)a=w(u,s.parentMap),e[o]=a.fullName,a.prefix||r.push(e[o]);return i.moduleDeps=(i.moduleDeps||[]).concat(r),t.require(e,n)}),c,r)}function L(e){f[e.id]||(f[e.id]=e,l.push(e),t.waitCount+=1)}function A(e){this.listeners.push(e)}function O(e,t){var n=e.fullName,r=e.prefix,i=r?d[r]||(d[r]=u[r]):null,o,f,l,v;return n&&(o=p[n]),o||(f=!0,o={id:(r&&!i?h++ +"__p@:":"")+(n||"__r@"+h++),map:e,depCount:0,depDone:[],depCallbacks:[],deps:[],listeners:[],add:A},s[o.id]=!0,n&&(!r||d[r])&&(p[n]=o)),r&&!i?(v=w(r),r in u&&!u[r]&&(delete u[r],delete c[v.url]),l=O(v,!0),l.add(function(t){var n=w(e.originalName,e.parentMap),r=O(n,!0);o.placeholder=!0,r.add(function(e){o.callback=function(){return e},N(o)})})):f&&t&&(a[o.id]=!1,T(o),L(o)),o}function M(e,n,i,o){var l=w(e,o),h=l.name,p=l.fullName,d=O(l),g=d.id,y=d.deps,b,E,S,T,k;if(p){if(p in u||a[g]===!0||p==="jquery"&&r.jQuery&&r.jQuery!==i().fn.jquery)return;s[g]=!0,a[g]=!0,p==="jquery"&&i&&jQueryCheck(i())}d.depArray=n,d.callback=i;for(b=0;b<n.length;b++)E=n[b],E&&(E=w(E,h?l:o),S=E.fullName,T=E.prefix,n[b]=S,S==="require"?y[b]=x(l):S==="exports"?(y[b]=u[p]={},d.usingExports=!0):S==="module"?d.cjsModule=k=y[b]={id:h,uri:h?t.nameToUrl(h,null,o):undefined,exports:u[p]}:!(S in u)||S in f||p in v&&!(p in v&&m[S])?(p in v&&(v[S]=!0,delete u[S],c[E.url]=!1),d.depCount+=1,d.depCallbacks[b]=C(d,b),O(E,!0).add(d.depCallbacks[b])):y[b]=u[S]);d.depCount?L(d):N(d)}function _(e){M.apply(null,e)}function D(e,t){var n=e.map.fullName,r=e.depArray,i=!0,s,o,u,l;if(e.isDone||!n||!a[n])return l;if(t[n])return e;t[n]=!0;if(r){for(s=0;s<r.length;s++){o=r[s];if(!a[o]&&!reservedDependencies[o]){i=!1;break}u=f[o];if(u&&!u.isDone&&a[o]){l=D(u,t);if(l)break}}i||(l=undefined,delete t[n])}return l}function P(e,t){var n=e.map.fullName,r=e.depArray,i,s,o,l,c,h;if(e.isDone||!n||!a[n])return undefined;if(n){if(t[n])return u[n];t[n]=!0}if(r)for(i=0;i<r.length;i++)s=r[i],s&&(l=w(s).prefix,l&&(c=f[l])&&P(c,t),o=f[s],o&&!o.isDone&&a[s]&&(h=P(o,t),e.depCallbacks[i](h)));return u[n]}function H(){var e=r.waitSeconds*1e3,i=e&&t.startTime+e<(new Date).getTime(),s="",o=!1,u=!1,c=[],h,d,v,m,g,y;if(t.pausedCount>0)return undefined;if(r.priorityWait){if(!E())return undefined;n()}for(d in a)if(!(d in empty)){o=!0;if(!a[d])if(i)s+=d+" ";else{u=!0;if(d.indexOf("!")===-1){c=[];break}y=p[d]&&p[d].moduleDeps,y&&c.push.apply(c,y)}}if(!o&&!t.waitCount)return undefined;if(i&&s)return v=makeError("timeout","Load timeout for modules: "+s),v.requireType="timeout",v.requireModules=s,req.onError(v);if(u&&c.length)for(h=0;m=f[c[h]];h++)if(g=D(m,{})){P(g,{});break}if(!i&&(u||t.scriptCount))return(isBrowser||isWebWorker)&&!checkLoadedTimeoutId&&(checkLoadedTimeoutId=setTimeout(function(){checkLoadedTimeoutId=0,H()},50)),undefined;if(t.waitCount){for(h=0;m=l[h];h++)P(m,{});t.paused.length&&n(),checkLoadedDepth<5&&(checkLoadedDepth+=1,H())}return checkLoadedDepth=0,req.checkReadyState(),undefined}var t,n,r={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},catchError:{}},i=[],s={require:!0,exports:!0,module:!0},o={},u={},a={},f={},l=[],c={},h=0,p={},d={},v={},m={},g=0;return jQueryCheck=function(e){if(!t.jQuery){var n=e||(typeof jQuery!="undefined"?jQuery:null);if(n){if(r.jQuery&&n.fn.jquery!==r.jQuery)return;if("holdReady"in n||"readyWait"in n)t.jQuery=n,_(["jquery",[],function(){return jQuery}]),t.scriptCount&&(jQueryHoldReady(n,!0),t.jQueryIncremented=!0)}}},n=function(){var e,n,s,o,u,f,l;t.takeGlobalQueue(),g+=1,t.scriptCount<=0&&(t.scriptCount=0);while(i.length){f=i.shift();if(f[0]===null)return req.onError(makeError("mismatch","Mismatched anonymous define() module: "+f[f.length-1]));_(f)}if(!r.priorityWait||E())while(t.paused.length){u=t.paused,t.pausedCount+=u.length,t.paused=[];for(o=0;e=u[o];o++)n=e.map,s=n.url,l=n.fullName,n.prefix?k(n.prefix,e):!c[s]&&!a[l]&&(req.load(t,l,s),s.indexOf("empty:")!==0&&(c[s]=!0));t.startTime=(new Date).getTime(),t.pausedCount-=u.length}return g===1&&H(),g-=1,undefined},t={contextName:e,config:r,defQueue:i,waiting:f,waitCount:0,specified:s,loaded:a,urlMap:o,urlFetched:c,scriptCount:0,defined:u,paused:[],pausedCount:0,plugins:d,needFullExec:v,fake:{},fullExec:m,managerCallbacks:p,makeModuleMap:w,normalize:b,configure:function(e){var i,s,o,u,a,f;e.baseUrl&&e.baseUrl.charAt(e.baseUrl.length-1)!=="/"&&(e.baseUrl+="/"),i=r.paths,o=r.packages,u=r.pkgs,mixin(r,e,!0);if(e.paths){for(s in e.paths)s in empty||(i[s]=e.paths[s]);r.paths=i}a=e.packagePaths;if(a||e.packages){if(a)for(s in a)s in empty||configurePackageDir(u,a[s],s);e.packages&&configurePackageDir(u,e.packages),r.pkgs=u}e.priority&&(f=t.requireWait,t.requireWait=!1,n(),t.require(e.priority),n(),t.requireWait=f,r.priorityWait=e.priority),(e.deps||e.callback)&&t.require(e.deps||[],e.callback)},requireDefined:function(e,t){return w(e,t).fullName in u},requireSpecified:function(e,t){return w(e,t).fullName in s},require:function(r,i,s){var o,a,f;if(typeof r=="string")return isFunction(i)?req.onError(makeError("requireargs","Invalid require call")):req.get?req.get(t,r,i):(o=r,s=i,f=w(o,s),a=f.fullName,a in u?u[a]:req.onError(makeError("notloaded","Module name '"+f.fullName+"' has not been loaded yet for context: "+e)));(r&&r.length||i)&&M(null,r,i,s);if(!t.requireWait)while(!t.scriptCount&&t.paused.length)n();return t.require},takeGlobalQueue:function(){globalDefQueue.length&&(apsp.apply(t.defQueue,[t.defQueue.length-1,0].concat(globalDefQueue)),globalDefQueue=[])},completeLoad:function(e){var r;t.takeGlobalQueue();while(i.length){r=i.shift();if(r[0]===null){r[0]=e;break}if(r[0]===e)break;_(r),r=null}r?_(r):_([e,[],e==="jquery"&&typeof jQuery!="undefined"?function(){return jQuery}:null]),req.isAsync&&(t.scriptCount-=1),n(),req.isAsync||(t.scriptCount-=1)},toUrl:function(e,n){var r=e.lastIndexOf("."),i=null;return r!==-1&&(i=e.substring(r,e.length),e=e.substring(0,r)),t.nameToUrl(e,i,n)},nameToUrl:function(e,n,r){var i,s,o,u,a,f,l,c,h=t.config;e=b(e,r&&r.fullName);if(req.jsExtRegExp.test(e))c=e+(n?n:"");else{i=h.paths,s=h.pkgs,a=e.split("/");for(f=a.length;f>0;f--){l=a.slice(0,f).join("/");if(i[l]){a.splice(0,f,i[l]);break}if(o=s[l]){e===o.name?u=o.location+"/"+o.main:u=o.location,a.splice(0,f,u);break}}c=a.join("/")+(n||".js"),c=(c.charAt(0)==="/"||c.match(/^\w+:/)?"":h.baseUrl)+c}return h.urlArgs?c+((c.indexOf("?")===-1?"?":"&")+h.urlArgs):c}},t.jQueryCheck=jQueryCheck,t.resume=n,t}function getInteractiveScript(){var e,t,n;if(interactiveScript&&interactiveScript.readyState==="interactive")return interactiveScript;e=document.getElementsByTagName("script");for(t=e.length-1;t>-1&&(n=e[t]);t--)if(n.readyState==="interactive")return interactiveScript=n;return null}var version="1.0.5",commentRegExp=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,cjsRequireRegExp=/require\(\s*["']([^'"\s]+)["']\s*\)/g,currDirRegExp=/^\.\//,jsSuffixRegExp=/\.js$/,ostring=Object.prototype.toString,ap=Array.prototype,aps=ap.slice,apsp=ap.splice,isBrowser=typeof window!="undefined"&&!!navigator&&!!document,isWebWorker=!isBrowser&&typeof importScripts!="undefined",readyRegExp=isBrowser&&navigator.platform==="PLAYSTATION 3"?/^complete$/:/^(complete|loaded)$/,defContextName="_",isOpera=typeof opera!="undefined"&&opera.toString()==="[object Opera]",empty={},contexts={},globalDefQueue=[],interactiveScript=null,checkLoadedDepth=0,useInteractive=!1,reservedDependencies={require:!0,module:!0,exports:!0},req,cfg={},currentlyAddingScript,s,head,baseElement,scripts,script,src,subPath,mainScript,dataMain,globalI,ctx,jQueryCheck,checkLoadedTimeoutId;if(typeof define!="undefined")return;if(typeof requirejs!="undefined"){if(isFunction(requirejs))return;cfg=requirejs,requirejs=undefined}typeof require!="undefined"&&!isFunction(require)&&(cfg=require,require=undefined),req=requirejs=function(e,t){var n=defContextName,r,i;return!isArray(e)&&typeof e!="string"&&(i=e,isArray(t)?(e=t,t=arguments[2]):e=[]),i&&i.context&&(n=i.context),r=contexts[n]||(contexts[n]=newContext(n)),i&&r.configure(i),r.require(e,t)},req.config=function(e){return req(e)},require||(require=req),req.toUrl=function(e){return contexts[defContextName].toUrl(e)},req.version=version,req.jsExtRegExp=/^\/|:|\?|\.js$/,s=req.s={contexts:contexts,skipAsync:{}},req.isAsync=req.isBrowser=isBrowser,isBrowser&&(head=s.head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0],baseElement&&(head=s.head=baseElement.parentNode)),req.onError=function(e){throw e},req.load=function(e,t,n){req.resourcesReady(!1),e.scriptCount+=1,req.attach(n,e,t),e.jQuery&&!e.jQueryIncremented&&(jQueryHoldReady(e.jQuery,!0),e.jQueryIncremented=!0)},define=function(e,t,n){var r,i;return typeof e!="string"&&(n=t,t=e,e=null),isArray(t)||(n=t,t=[]),!t.length&&isFunction(n)&&n.length&&(n.toString().replace(commentRegExp,"").replace(cjsRequireRegExp,function(e,n){t.push(n)}),t=(n.length===1?["require"]:["require","exports","module"]).concat(t)),useInteractive&&(r=currentlyAddingScript||getInteractiveScript(),r&&(e||(e=r.getAttribute("data-requiremodule")),i=contexts[r.getAttribute("data-requirecontext")])),(i?i.defQueue:globalDefQueue).push([e,t,n]),undefined},define.amd={multiversion:!0,plugins:!0,jQuery:!0},req.exec=function(text){return eval(text)},req.execCb=function(e,t,n,r){return t.apply(r,n)},req.addScriptToDom=function(e){currentlyAddingScript=e,baseElement?head.insertBefore(e,baseElement):head.appendChild(e),currentlyAddingScript=null},req.onScriptLoad=function(e){var t=e.currentTarget||e.srcElement,n,r,i;if(e.type==="load"||t&&readyRegExp.test(t.readyState))interactiveScript=null,n=t.getAttribute("data-requirecontext"),r=t.getAttribute("data-requiremodule"),i=contexts[n],contexts[n].completeLoad(r),t.detachEvent&&!isOpera?t.detachEvent("onreadystatechange",req.onScriptLoad):t.removeEventListener("load",req.onScriptLoad,!1)},req.attach=function(e,t,n,r,i,o){var u;return isBrowser?(r=r||req.onScriptLoad,u=t&&t.config&&t.config.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script"),u.type=i||t&&t.config.scriptType||"text/javascript",u.charset="utf-8",u.async=!s.skipAsync[e],t&&u.setAttribute("data-requirecontext",t.contextName),u.setAttribute("data-requiremodule",n),u.attachEvent&&!isOpera?(useInteractive=!0,o?u.onreadystatechange=function(e){u.readyState==="loaded"&&(u.onreadystatechange=null,u.attachEvent("onreadystatechange",r),o(u))}:u.attachEvent("onreadystatechange",r)):u.addEventListener("load",r,!1),u.src=e,o||req.addScriptToDom(u),u):(isWebWorker&&(importScripts(e),t.completeLoad(n)),null)};if(isBrowser){scripts=document.getElementsByTagName("script");for(globalI=scripts.length-1;globalI>-1&&(script=scripts[globalI]);globalI--){head||(head=script.parentNode);if(dataMain=script.getAttribute("data-main")){cfg.baseUrl||(src=dataMain.split("/"),mainScript=src.pop(),subPath=src.length?src.join("/")+"/":"./",cfg.baseUrl=subPath,dataMain=mainScript.replace(jsSuffixRegExp,"")),cfg.deps=cfg.deps?cfg.deps.concat(dataMain):[dataMain];break}}}req.checkReadyState=function(){var e=s.contexts,t;for(t in e)if(!(t in empty)&&e[t].waitCount)return;req.resourcesReady(!0)},req.resourcesReady=function(e){var t,n,r;req.resourcesDone=e;if(req.resourcesDone){t=s.contexts;for(r in t)r in empty||(n=t[r],n.jQueryIncremented&&(jQueryHoldReady(n.jQuery,!1),n.jQueryIncremented=!1))}},req.pageLoaded=function(){document.readyState!=="complete"&&(document.readyState="complete")},isBrowser&&document.addEventListener&&(document.readyState||(document.readyState="loading",window.addEventListener("load",req.pageLoaded,!1))),req(cfg),req.isAsync&&typeof setTimeout!="undefined"&&(ctx=s.contexts[cfg.context||defContextName],ctx.requireWait=!0,setTimeout(function(){ctx.requireWait=!1,ctx.scriptCount||ctx.resume(),req.checkReadyState()},0))})(),define("requireLib",function(){}),define("lib/codes",[],function(){var e={hStatus:"hStatus",hResult:"hResult",hMessage:"hMessage"},t={NO_ERROR:0,JID_MALFORMAT:1,CONN_TIMEOUT:2,AUTH_FAILED:3,ATTACH_FAILED:4,ALREADY_CONNECTED:5,TECH_ERROR:6,NOT_CONNECTED:7,CONN_PROGRESS:8,ALREADY_SUBSCRIBED:1,GET_SUBS_FAILED:2},n={CONNECTING:1,CONNECTED:2,DISCONNECTING:5,DISCONNECTED:6},r={OK:0,TECH_ERROR:1,NOT_CONNECTED:3,NOT_AUTHORIZED:5,MISSING_ATTR:6,INVALID_ATTR:7,NOT_AVAILABLE:9,EXEC_TIMEOUT:10};return{errors:t,statuses:n,hResultStatus:r,types:e}});var io="undefined"==typeof module?{}:module.exports;(function(){(function(e,t){var n=e;n.version="0.9.10",n.protocol=1,n.transports=[],n.j=[],n.sockets={},n.connect=function(e,r){var i=n.util.parseUri(e),s,o;t&&t.location&&(i.protocol=i.protocol||t.location.protocol.slice(0,-1),i.host=i.host||(t.document?t.document.domain:t.location.hostname),i.port=i.port||t.location.port),s=n.util.uniqueUri(i);var u={host:i.host,secure:"https"==i.protocol,port:i.port||("https"==i.protocol?443:80),query:i.query||""};n.util.merge(u,r);if(u["force new connection"]||!n.sockets[s])o=new n.Socket(u);return!u["force new connection"]&&o&&(n.sockets[s]=o),o=o||n.sockets[s],o.of(i.path.length>1?i.path:"")}})("object"==typeof module?module.exports:this.io={},this),function(e,t){var n=e.util={},r=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,i=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];n.parseUri=function(e){var t=r.exec(e||""),n={},s=14;while(s--)n[i[s]]=t[s]||"";return n},n.uniqueUri=function(e){var n=e.protocol,r=e.host,i=e.port;return"document"in t?(r=r||document.domain,i=i||(n=="https"&&document.location.protocol!=="https:"?443:document.location.port)):(r=r||"localhost",!i&&n=="https"&&(i=443)),(n||"http")+"://"+r+":"+(i||80)},n.query=function(e,t){var r=n.chunkQuery(e||""),i=[];n.merge(r,n.chunkQuery(t||""));for(var s in r)r.hasOwnProperty(s)&&i.push(s+"="+r[s]);return i.length?"?"+i.join("&"):""},n.chunkQuery=function(e){var t={},n=e.split("&"),r=0,i=n.length,s;for(;r<i;++r)s=n[r].split("="),s[0]&&(t[s[0]]=s[1]);return t};var s=!1;n.load=function(e){if("document"in t&&document.readyState==="complete"||s)return e();n.on(t,"load",e,!1)},n.on=function(e,t,n,r){e.attachEvent?e.attachEvent("on"+t,n):e.addEventListener&&e.addEventListener(t,n,r)},n.request=function(e){if(e&&"undefined"!=typeof XDomainRequest)return new XDomainRequest;if("undefined"!=typeof XMLHttpRequest&&(!e||n.ua.hasCORS))return new XMLHttpRequest;if(!e)try{return new(window[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}return null},"undefined"!=typeof window&&n.load(function(){s=!0}),n.defer=function(e){if(!n.ua.webkit||"undefined"!=typeof importScripts)return e();n.load(function(){setTimeout(e,100)})},n.merge=function(t,r,i,s){var o=s||[],u=typeof i=="undefined"?2:i,a;for(a in r)r.hasOwnProperty(a)&&n.indexOf(o,a)<0&&(typeof t[a]!="object"||!u?(t[a]=r[a],o.push(r[a])):n.merge(t[a],r[a],u-1,o));return t},n.mixin=function(e,t){n.merge(e.prototype,t.prototype)},n.inherit=function(e,t){function n(){}n.prototype=t.prototype,e.prototype=new n},n.isArray=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},n.intersect=function(e,t){var r=[],i=e.length>t.length?e:t,s=e.length>t.length?t:e;for(var o=0,u=s.length;o<u;o++)~n.indexOf(i,s[o])&&r.push(s[o]);return r},n.indexOf=function(e,t,n){for(var r=e.length,n=n<0?n+r<0?0:n+r:n||0;n<r&&e[n]!==t;n++);return r<=n?-1:n},n.toArray=function(e){var t=[];for(var n=0,r=e.length;n<r;n++)t.push(e[n]);return t},n.ua={},n.ua.hasCORS="undefined"!=typeof XMLHttpRequest&&function(){try{var e=new XMLHttpRequest}catch(t){return!1}return e.withCredentials!=undefined}(),n.ua.webkit="undefined"!=typeof navigator&&/webkit/i.test(navigator.userAgent),n.ua.iDevice="undefined"!=typeof navigator&&/iPad|iPhone|iPod/i.test(navigator.userAgent)}("undefined"!=typeof io?io:module.exports,this),function(e,t){function n(){}e.EventEmitter=n,n.prototype.on=function(e,n){return this.$events||(this.$events={}),this.$events[e]?t.util.isArray(this.$events[e])?this.$events[e].push(n):this.$events[e]=[this.$events[e],n]:this.$events[e]=n,this},n.prototype.addListener=n.prototype.on,n.prototype.once=function(e,t){function r(){n.removeListener(e,r),t.apply(this,arguments)}var n=this;return r.listener=t,this.on(e,r),this},n.prototype.removeListener=function(e,n){if(this.$events&&this.$events[e]){var r=this.$events[e];if(t.util.isArray(r)){var i=-1;for(var s=0,o=r.length;s<o;s++)if(r[s]===n||r[s].listener&&r[s].listener===n){i=s;break}if(i<0)return this;r.splice(i,1),r.length||delete this.$events[e]}else(r===n||r.listener&&r.listener===n)&&delete this.$events[e]}return this},n.prototype.removeAllListeners=function(e){return e===undefined?(this.$events={},this):(this.$events&&this.$events[e]&&(this.$events[e]=null),this)},n.prototype.listeners=function(e){return this.$events||(this.$events={}),this.$events[e]||(this.$events[e]=[]),t.util.isArray(this.$events[e])||(this.$events[e]=[this.$events[e]]),this.$events[e]},n.prototype.emit=function(e){if(!this.$events)return!1;var n=this.$events[e];if(!n)return!1;var r=Array.prototype.slice.call(arguments,1);if("function"==typeof n)n.apply(this,r);else{if(!t.util.isArray(n))return!1;var i=n.slice();for(var s=0,o=i.length;s<o;s++)i[s].apply(this,r)}return!0}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(exports,nativeJSON){function f(e){return e<10?"0"+e:e}function date(e,t){return isFinite(e.valueOf())?e.getUTCFullYear()+"-"+f(e.getUTCMonth()+1)+"-"+f(e.getUTCDate())+"T"+f(e.getUTCHours())+":"+f(e.getUTCMinutes())+":"+f(e.getUTCSeconds())+"Z":null}function quote(e){return escapable.lastIndex=0,escapable.test(e)?'"'+e.replace(escapable,function(e){var t=meta[e];return typeof t=="string"?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}function str(e,t){var n,r,i,s,o=gap,u,a=t[e];a instanceof Date&&(a=date(e)),typeof rep=="function"&&(a=rep.call(t,e,a));switch(typeof a){case"string":return quote(a);case"number":return isFinite(a)?String(a):"null";case"boolean":case"null":return String(a);case"object":if(!a)return"null";gap+=indent,u=[];if(Object.prototype.toString.apply(a)==="[object Array]"){s=a.length;for(n=0;n<s;n+=1)u[n]=str(n,a)||"null";return i=u.length===0?"[]":gap?"[\n"+gap+u.join(",\n"+gap)+"\n"+o+"]":"["+u.join(",")+"]",gap=o,i}if(rep&&typeof rep=="object"){s=rep.length;for(n=0;n<s;n+=1)typeof rep[n]=="string"&&(r=rep[n],i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i))}else for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(i=str(r,a),i&&u.push(quote(r)+(gap?": ":":")+i));return i=u.length===0?"{}":gap?"{\n"+gap+u.join(",\n"+gap)+"\n"+o+"}":"{"+u.join(",")+"}",gap=o,i}}if(nativeJSON&&nativeJSON.parse)return exports.JSON={parse:nativeJSON.parse,stringify:nativeJSON.stringify};var JSON=exports.JSON={},cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;JSON.stringify=function(e,t,n){var r;gap="",indent="";if(typeof n=="number")for(r=0;r<n;r+=1)indent+=" ";else typeof n=="string"&&(indent=n);rep=t;if(!t||typeof t=="function"||typeof t=="object"&&typeof t.length=="number")return str("",{"":e});throw new Error("JSON.stringify")},JSON.parse=function(text,reviver){function walk(e,t){var n,r,i=e[t];if(i&&typeof i=="object")for(n in i)Object.prototype.hasOwnProperty.call(i,n)&&(r=walk(i,n),r!==undefined?i[n]=r:delete i[n]);return reviver.call(e,t,i)}var j;text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),typeof reviver=="function"?walk({"":j},""):j;throw new SyntaxError("JSON.parse")}}("undefined"!=typeof io?io:module.exports,typeof JSON!="undefined"?JSON:undefined),function(e,t){var n=e.parser={},r=n.packets=["disconnect","connect","heartbeat","message","json","event","ack","error","noop"],i=n.reasons=["transport not supported","client not handshaken","unauthorized"],s=n.advice=["reconnect"],o=t.JSON,u=t.util.indexOf;n.encodePacket=function(e){var t=u(r,e.type),n=e.id||"",a=e.endpoint||"",f=e.ack,l=null;switch(e.type){case"error":var c=e.reason?u(i,e.reason):"",h=e.advice?u(s,e.advice):"";if(c!==""||h!=="")l=c+(h!==""?"+"+h:"");break;case"message":e.data!==""&&(l=e.data);break;case"event":var p={name:e.name};e.args&&e.args.length&&(p.args=e.args),l=o.stringify(p);break;case"json":l=o.stringify(e.data);break;case"connect":e.qs&&(l=e.qs);break;case"ack":l=e.ackId+(e.args&&e.args.length?"+"+o.stringify(e.args):"")}var d=[t,n+(f=="data"?"+":""),a];return l!==null&&l!==undefined&&d.push(l),d.join(":")},n.encodePayload=function(e){var t="";if(e.length==1)return e[0];for(var n=0,r=e.length;n<r;n++){var i=e[n];t+="�"+i.length+"�"+e[n]}return t};var a=/([^:]+):([0-9]+)?(\+)?:([^:]+)?:?([\s\S]*)?/;n.decodePacket=function(e){var t=e.match(a);if(!t)return{};var n=t[2]||"",e=t[5]||"",u={type:r[t[1]],endpoint:t[4]||""};n&&(u.id=n,t[3]?u.ack="data":u.ack=!0);switch(u.type){case"error":var t=e.split("+");u.reason=i[t[0]]||"",u.advice=s[t[1]]||"";break;case"message":u.data=e||"";break;case"event":try{var f=o.parse(e);u.name=f.name,u.args=f.args}catch(l){}u.args=u.args||[];break;case"json":try{u.data=o.parse(e)}catch(l){}break;case"connect":u.qs=e||"";break;case"ack":var t=e.match(/^([0-9]+)(\+)?(.*)/);if(t){u.ackId=t[1],u.args=[];if(t[3])try{u.args=t[3]?o.parse(t[3]):[]}catch(l){}}break;case"disconnect":case"heartbeat":}return u},n.decodePayload=function(e){if(e.charAt(0)=="�"){var t=[];for(var r=1,i="";r<e.length;r++)e.charAt(r)=="�"?(t.push(n.decodePacket(e.substr(r+1).substr(0,i))),r+=Number(i)+1,i=""):i+=e.charAt(r);return t}return[n.decodePacket(e)]}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t){function n(e,t){this.socket=e,this.sessid=t}e.Transport=n,t.util.mixin(n,t.EventEmitter),n.prototype.heartbeats=function(){return!0},n.prototype.onData=function(e){this.clearCloseTimeout(),(this.socket.connected||this.socket.connecting||this.socket.reconnecting)&&this.setCloseTimeout();if(e!==""){var n=t.parser.decodePayload(e);if(n&&n.length)for(var r=0,i=n.length;r<i;r++)this.onPacket(n[r])}return this},n.prototype.onPacket=function(e){return this.socket.setHeartbeatTimeout(),e.type=="heartbeat"?this.onHeartbeat():(e.type=="connect"&&e.endpoint==""&&this.onConnect(),e.type=="error"&&e.advice=="reconnect"&&(this.isOpen=!1),this.socket.onPacket(e),this)},n.prototype.setCloseTimeout=function(){if(!this.closeTimeout){var e=this;this.closeTimeout=setTimeout(function(){e.onDisconnect()},this.socket.closeTimeout)}},n.prototype.onDisconnect=function(){return this.isOpen&&this.close(),this.clearTimeouts(),this.socket.onDisconnect(),this},n.prototype.onConnect=function(){return this.socket.onConnect(),this},n.prototype.clearCloseTimeout=function(){this.closeTimeout&&(clearTimeout(this.closeTimeout),this.closeTimeout=null)},n.prototype.clearTimeouts=function(){this.clearCloseTimeout(),this.reopenTimeout&&clearTimeout(this.reopenTimeout)},n.prototype.packet=function(e){this.send(t.parser.encodePacket(e))},n.prototype.onHeartbeat=function(e){this.packet({type:"heartbeat"})},n.prototype.onOpen=function(){this.isOpen=!0,this.clearCloseTimeout(),this.socket.onOpen()},n.prototype.onClose=function(){var e=this;this.isOpen=!1,this.socket.onClose(),this.onDisconnect()},n.prototype.prepareUrl=function(){var e=this.socket.options;return this.scheme()+"://"+e.host+":"+e.port+"/"+e.resource+"/"+t.protocol+"/"+this.name+"/"+this.sessid},n.prototype.ready=function(e,t){t.call(this)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t,n){function r(e){this.options={port:80,secure:!1,document:"document"in n?document:!1,resource:"socket.io",transports:t.transports,"connect timeout":1e4,"try multiple transports":!0,reconnect:!0,"reconnection delay":500,"reconnection limit":Infinity,"reopen delay":3e3,"max reconnection attempts":10,"sync disconnect on unload":!1,"auto connect":!0,"flash policy port":10843,manualFlush:!1},t.util.merge(this.options,e),this.connected=!1,this.open=!1,this.connecting=!1,this.reconnecting=!1,this.namespaces={},this.buffer=[],this.doBuffer=!1;if(this.options["sync disconnect on unload"]&&(!this.isXDomain()||t.util.ua.hasCORS)){var r=this;t.util.on(n,"beforeunload",function(){r.disconnectSync()},!1)}this.options["auto connect"]&&this.connect()}function i(){}e.Socket=r,t.util.mixin(r,t.EventEmitter),r.prototype.of=function(e){return this.namespaces[e]||(this.namespaces[e]=new t.SocketNamespace(this,e),e!==""&&this.namespaces[e].packet({type:"connect"})),this.namespaces[e]},r.prototype.publish=function(){this.emit.apply(this,arguments);var e;for(var t in this.namespaces)this.namespaces.hasOwnProperty(t)&&(e=this.of(t),e.$emit.apply(e,arguments))},r.prototype.handshake=function(e){function s(t){t instanceof Error?(n.connecting=!1,n.onError(t.message)):e.apply(null,t.split(":"))}var n=this,r=this.options,o=["http"+(r.secure?"s":"")+":/",r.host+":"+r.port,r.resource,t.protocol,t.util.query(this.options.query,"t="+ +(new Date))].join("/");if(this.isXDomain()&&!t.util.ua.hasCORS){var u=document.getElementsByTagName("script")[0],a=document.createElement("script");a.src=o+"&jsonp="+t.j.length,u.parentNode.insertBefore(a,u),t.j.push(function(e){s(e),a.parentNode.removeChild(a)})}else{var f=t.util.request();f.open("GET",o,!0),this.isXDomain()&&(f.withCredentials=!0),f.onreadystatechange=function(){f.readyState==4&&(f.onreadystatechange=i,f.status==200?s(f.responseText):f.status==403?n.onError(f.responseText):(n.connecting=!1,!n.reconnecting&&n.onError(f.responseText)))},f.send(null)}},r.prototype.getTransport=function(e){var n=e||this.transports,r;for(var i=0,s;s=n[i];i++)if(t.Transport[s]&&t.Transport[s].check(this)&&(!this.isXDomain()||t.Transport[s].xdomainCheck(this)))return new t.Transport[s](this,this.sessionid);return null},r.prototype.connect=function(e){if(this.connecting)return this;var n=this;return n.connecting=!0,this.handshake(function(r,i,s,o){function u(e){n.transport&&n.transport.clearTimeouts(),n.transport=n.getTransport(e);if(!n.transport)return n.publish("connect_failed");n.transport.ready(n,function(){n.connecting=!0,n.publish("connecting",n.transport.name),n.transport.open(),n.options["connect timeout"]&&(n.connectTimeoutTimer=setTimeout(function(){if(!n.connected){n.connecting=!1;if(n.options["try multiple transports"]){var e=n.transports;while(e.length>0&&e.splice(0,1)[0]!=n.transport.name);e.length?u(e):n.publish("connect_failed")}}},n.options["connect timeout"]))})}n.sessionid=r,n.closeTimeout=s*1e3,n.heartbeatTimeout=i*1e3,n.transports||(n.transports=n.origTransports=o?t.util.intersect(o.split(","),n.options.transports):n.options.transports),n.setHeartbeatTimeout(),u(n.transports),n.once("connect",function(){clearTimeout(n.connectTimeoutTimer),e&&typeof e=="function"&&e()})}),this},r.prototype.setHeartbeatTimeout=function(){clearTimeout(this.heartbeatTimeoutTimer);if(this.transport&&!this.transport.heartbeats())return;var e=this;this.heartbeatTimeoutTimer=setTimeout(function(){e.transport.onClose()},this.heartbeatTimeout)},r.prototype.packet=function(e){return this.connected&&!this.doBuffer?this.transport.packet(e):this.buffer.push(e),this},r.prototype.setBuffer=function(e){this.doBuffer=e,!e&&this.connected&&this.buffer.length&&(this.options.manualFlush||this.flushBuffer())},r.prototype.flushBuffer=function(){this.transport.payload(this.buffer),this.buffer=[]},r.prototype.disconnect=function(){if(this.connected||this.connecting)this.open&&this.of("").packet({type:"disconnect"}),this.onDisconnect("booted");return this},r.prototype.disconnectSync=function(){var e=t.util.request(),n=["http"+(this.options.secure?"s":"")+":/",this.options.host+":"+this.options.port,this.options.resource,t.protocol,"",this.sessionid].join("/")+"/?disconnect=1";e.open("GET",n,!1),e.send(null),this.onDisconnect("booted")},r.prototype.isXDomain=function(){var e=n.location.port||("https:"==n.location.protocol?443:80);return this.options.host!==n.location.hostname||this.options.port!=e},r.prototype.onConnect=function(){this.connected||(this.connected=!0,this.connecting=!1,this.doBuffer||this.setBuffer(!1),this.emit("connect"))},r.prototype.onOpen=function(){this.open=!0},r.prototype.onClose=function(){this.open=!1,clearTimeout(this.heartbeatTimeoutTimer)},r.prototype.onPacket=function(e){this.of(e.endpoint).onPacket(e)},r.prototype.onError=function(e){e&&e.advice&&e.advice==="reconnect"&&(this.connected||this.connecting)&&(this.disconnect(),this.options.reconnect&&this.reconnect()),this.publish("error",e&&e.reason?e.reason:e)},r.prototype.onDisconnect=function(e){var t=this.connected,n=this.connecting;this.connected=!1,this.connecting=!1,this.open=!1;if(t||n)this.transport.close(),this.transport.clearTimeouts(),t&&(this.publish("disconnect",e),"booted"!=e&&this.options.reconnect&&!this.reconnecting&&this.reconnect())},r.prototype.reconnect=function(){function i(){if(e.connected){for(var t in e.namespaces)e.namespaces.hasOwnProperty(t)&&""!==t&&e.namespaces[t].packet({type:"connect"});e.publish("reconnect",e.transport.name,e.reconnectionAttempts)}clearTimeout(e.reconnectionTimer),e.removeListener("connect_failed",s),e.removeListener("connect",s),e.reconnecting=!1,delete e.reconnectionAttempts,delete e.reconnectionDelay,delete e.reconnectionTimer,delete e.redoTransports,e.options["try multiple transports"]=n}function s(){if(!e.reconnecting)return;if(e.connected)return i();if(e.connecting&&e.reconnecting)return e.reconnectionTimer=setTimeout(s,1e3);e.reconnectionAttempts++>=t?e.redoTransports?(e.publish("reconnect_failed"),i()):(e.on("connect_failed",s),e.options["try multiple transports"]=!0,e.transports=e.origTransports,e.transport=e.getTransport(),e.redoTransports=!0,e.connect()):(e.reconnectionDelay<r&&(e.reconnectionDelay*=2),e.connect(),e.publish("reconnecting",e.reconnectionDelay,e.reconnectionAttempts),e.reconnectionTimer=setTimeout(s,e.reconnectionDelay))}this.reconnecting=!0,this.reconnectionAttempts=0,this.reconnectionDelay=this.options["reconnection delay"];var e=this,t=this.options["max reconnection attempts"],n=this.options["try multiple transports"],r=this.options["reconnection limit"];this.options["try multiple transports"]=!1,this.reconnectionTimer=setTimeout(s,this.reconnectionDelay),this.on("connect",s)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t){function n(e,t){this.socket=e,this.name=t||"",this.flags={},this.json=new r(this,"json"),this.ackPackets=0,this.acks={}}function r(e,t){this.namespace=e,this.name=t}e.SocketNamespace=n,t.util.mixin(n,t.EventEmitter),n.prototype.$emit=t.EventEmitter.prototype.emit,n.prototype.of=function(){return this.socket.of.apply(this.socket,arguments)},n.prototype.packet=function(e){return e.endpoint=this.name,this.socket.packet(e),this.flags={},this},n.prototype.send=function(e,t){var n={type:this.flags.json?"json":"message",data:e};return"function"==typeof t&&(n.id=++this.ackPackets,n.ack=!0,this.acks[n.id]=t),this.packet(n)},n.prototype.emit=function(e){var t=Array.prototype.slice.call(arguments,1),n=t[t.length-1],r={type:"event",name:e};return"function"==typeof n&&(r.id=++this.ackPackets,r.ack="data",this.acks[r.id]=n,t=t.slice(0,t.length-1)),r.args=t,this.packet(r)},n.prototype.disconnect=function(){return this.name===""?this.socket.disconnect():(this.packet({type:"disconnect"}),this.$emit("disconnect")),this},n.prototype.onPacket=function(e){function r(){n.packet({type:"ack",args:t.util.toArray(arguments),ackId:e.id})}var n=this;switch(e.type){case"connect":this.$emit("connect");break;case"disconnect":this.name===""?this.socket.onDisconnect(e.reason||"booted"):this.$emit("disconnect",e.reason);break;case"message":case"json":var i=["message",e.data];e.ack=="data"?i.push(r):e.ack&&this.packet({type:"ack",ackId:e.id}),this.$emit.apply(this,i);break;case"event":var i=[e.name].concat(e.args);e.ack=="data"&&i.push(r),this.$emit.apply(this,i);break;case"ack":this.acks[e.ackId]&&(this.acks[e.ackId].apply(this,e.args),delete this.acks[e.ackId]);break;case"error":e.advice?this.socket.onError(e):e.reason=="unauthorized"?this.$emit("connect_failed",e.reason):this.$emit("error",e.reason)}},r.prototype.send=function(){this.namespace.flags[this.name]=!0,this.namespace.send.apply(this.namespace,arguments)},r.prototype.emit=function(){this.namespace.flags[this.name]=!0,this.namespace.emit.apply(this.namespace,arguments)}}("undefined"!=typeof io?io:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t,n){function r(e){t.Transport.apply(this,arguments)}e.websocket=r,t.util.inherit(r,t.Transport),r.prototype.name="websocket",r.prototype.open=function(){var e=t.util.query(this.socket.options.query),r=this,i;return i||(i=n.MozWebSocket||n.WebSocket),this.websocket=new i(this.prepareUrl()+e),this.websocket.onopen=function(){r.onOpen(),r.socket.setBuffer(!1)},this.websocket.onmessage=function(e){r.onData(e.data)},this.websocket.onclose=function(){r.onClose(),r.socket.setBuffer(!0)},this.websocket.onerror=function(e){r.onError(e)},this},t.util.ua.iDevice?r.prototype.send=function(e){var t=this;return setTimeout(function(){t.websocket.send(e)},0),this}:r.prototype.send=function(e){return this.websocket.send(e),this},r.prototype.payload=function(e){for(var t=0,n=e.length;t<n;t++)this.packet(e[t]);return this},r.prototype.close=function(){return this.websocket.close(),this},r.prototype.onError=function(e){this.socket.onError(e)},r.prototype.scheme=function(){return this.socket.options.secure?"wss":"ws"},r.check=function(){return"WebSocket"in n&&!("__addTask"in WebSocket)||"MozWebSocket"in n},r.xdomainCheck=function(){return!0},t.transports.push("websocket")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t,n){function r(e){if(!e)return;t.Transport.apply(this,arguments),this.sendBuffer=[]}function i(){}e.XHR=r,t.util.inherit(r,t.Transport),r.prototype.open=function(){return this.socket.setBuffer(!1),this.onOpen(),this.get(),this.setCloseTimeout(),this},r.prototype.payload=function(e){var n=[];for(var r=0,i=e.length;r<i;r++)n.push(t.parser.encodePacket(e[r]));this.send(t.parser.encodePayload(n))},r.prototype.send=function(e){return this.post(e),this},r.prototype.post=function(e){function r(){this.readyState==4&&(this.onreadystatechange=i,t.posting=!1,this.status==200?t.socket.setBuffer(!1):t.onClose())}function s(){this.onload=i,t.socket.setBuffer(!1)}var t=this;this.socket.setBuffer(!0),this.sendXHR=this.request("POST"),n.XDomainRequest&&this.sendXHR instanceof XDomainRequest?this.sendXHR.onload=this.sendXHR.onerror=s:this.sendXHR.onreadystatechange=r,this.sendXHR.send(e)},r.prototype.close=function(){return this.onClose(),this},r.prototype.request=function(e){var n=t.util.request(this.socket.isXDomain()),r=t.util.query(this.socket.options.query,"t="+ +(new Date));n.open(e||"GET",this.prepareUrl()+r,!0);if(e=="POST")try{n.setRequestHeader?n.setRequestHeader("Content-type","text/plain;charset=UTF-8"):n.contentType="text/plain"}catch(i){}return n},r.prototype.scheme=function(){return this.socket.options.secure?"https":"http"},r.check=function(e,r){try{var i=t.util.request(r),s=n.XDomainRequest&&i instanceof XDomainRequest,o=e&&e.options&&e.options.secure?"https:":"http:",u=o!=n.location.protocol;if(i&&(!s||!u))return!0}catch(a){}return!1},r.xdomainCheck=function(e){return r.check(e,!0)}}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t){function n(e){t.Transport.XHR.apply(this,arguments)}e.htmlfile=n,t.util.inherit(n,t.Transport.XHR),n.prototype.name="htmlfile",n.prototype.get=function(){this.doc=new(window[["Active"].concat("Object").join("X")])("htmlfile"),this.doc.open(),this.doc.write("<html></html>"),this.doc.close(),this.doc.parentWindow.s=this;var e=this.doc.createElement("div");e.className="socketio",this.doc.body.appendChild(e),this.iframe=this.doc.createElement("iframe"),e.appendChild(this.iframe);var n=this,r=t.util.query(this.socket.options.query,"t="+ +(new Date));this.iframe.src=this.prepareUrl()+r,t.util.on(window,"unload",function(){n.destroy()})},n.prototype._=function(e,t){this.onData(e);try{var n=t.getElementsByTagName("script")[0];n.parentNode.removeChild(n)}catch(r){}},n.prototype.destroy=function(){if(this.iframe){try{this.iframe.src="about:blank"}catch(e){}this.doc=null,this.iframe.parentNode.removeChild(this.iframe),this.iframe=null,CollectGarbage()}},n.prototype.close=function(){return this.destroy(),t.Transport.XHR.prototype.close.call(this)},n.check=function(e){if(typeof window!="undefined"&&["Active"].concat("Object").join("X")in window)try{var n=new(window[["Active"].concat("Object").join("X")])("htmlfile");return n&&t.Transport.XHR.check(e)}catch(r){}return!1},n.xdomainCheck=function(){return!1},t.transports.push("htmlfile")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports),function(e,t,n){function r(){t.Transport.XHR.apply(this,arguments)}function i(){}e["xhr-polling"]=r,t.util.inherit(r,t.Transport.XHR),t.util.merge(r,t.Transport.XHR),r.prototype.name="xhr-polling",r.prototype.heartbeats=function(){return!1},r.prototype.open=function(){var e=this;return t.Transport.XHR.prototype.open.call(e),!1},r.prototype.get=function(){function t(){this.readyState==4&&(this.onreadystatechange=i,this.status==200?(e.onData(this.responseText),e.get()):e.onClose())}function r(){this.onload=i,this.onerror=i,e.onData(this.responseText),e.get()}function s(){e.onClose()}if(!this.isOpen)return;var e=this;this.xhr=this.request(),n.XDomainRequest&&this.xhr instanceof XDomainRequest?(this.xhr.onload=r,this.xhr.onerror=s):this.xhr.onreadystatechange=t,this.xhr.send(null)},r.prototype.onClose=function(){t.Transport.XHR.prototype.onClose.call(this);if(this.xhr){this.xhr.onreadystatechange=this.xhr.onload=this.xhr.onerror=i;try{this.xhr.abort()}catch(e){}this.xhr=null}},r.prototype.ready=function(e,n){var r=this;t.util.defer(function(){n.call(r)})},t.transports.push("xhr-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this),function(e,t,n){function i(e){t.Transport["xhr-polling"].apply(this,arguments),this.index=t.j.length;var n=this;t.j.push(function(e){n._(e)})}var r=n.document&&"MozAppearance"in n.document.documentElement.style;e["jsonp-polling"]=i,t.util.inherit(i,t.Transport["xhr-polling"]),i.prototype.name="jsonp-polling",i.prototype.post=function(e){function a(){f(),n.socket.setBuffer(!1)}function f(){n.iframe&&n.form.removeChild(n.iframe);try{u=document.createElement('<iframe name="'+n.iframeId+'">')}catch(e){u=document.createElement("iframe"),u.name=n.iframeId}u.id=n.iframeId,n.form.appendChild(u),n.iframe=u}var n=this,r=t.util.query(this.socket.options.query,"t="+ +(new Date)+"&i="+this.index);if(!this.form){var i=document.createElement("form"),s=document.createElement("textarea"),o=this.iframeId="socketio_iframe_"+this.index,u;i.className="socketio",i.style.position="absolute",i.style.top="0px",i.style.left="0px",i.style.display="none",i.target=o,i.method="POST",i.setAttribute("accept-charset","utf-8"),s.name="d",i.appendChild(s),document.body.appendChild(i),this.form=i,this.area=s}this.form.action=this.prepareUrl()+r,f(),this.area.value=t.JSON.stringify(e);try{this.form.submit()}catch(l){}this.iframe.attachEvent?u.onreadystatechange=function(){n.iframe.readyState=="complete"&&a()}:this.iframe.onload=a,this.socket.setBuffer(!0)},i.prototype.get=function(){var e=this,n=document.createElement("script"),i=t.util.query(this.socket.options.query,"t="+ +(new Date)+"&i="+this.index);this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),n.async=!0,n.src=this.prepareUrl()+i,n.onerror=function(){e.onClose()};var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(n,s),this.script=n,r&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},i.prototype._=function(e){return this.onData(e),this.isOpen&&this.get(),this},i.prototype.ready=function(e,n){var i=this;if(!r)return n.call(this);t.util.load(function(){n.call(i)})},i.check=function(){return"document"in n},i.xdomainCheck=function(){return!0},t.transports.push("jsonp-polling")}("undefined"!=typeof io?io.Transport:module.exports,"undefined"!=typeof io?io:module.parent.exports,this)})(),define("lib/transports/socketio/socket.io",function(){}),define("lib/transports/socketio/hsession-socketio",["../../codes","./socket.io"],function(e,t){var n=e.statuses,r=e.errors;typeof module!="undefined"&&module.exports&&(io=require("socket.io-client")),io=io||t;var i=function(e,t,i,s){this.opts=s,this.publisher=e,this.password=t,this.callback=i,this.retryIntervals=s.retryIntervals,this.status=n.DISCONNECTED,this.errorCode=r.NO_ERROR};return i.prototype.connect=function(e){var t=this,i,s=new RegExp(this.publisher,"i");if(!this.opts.stress&&typeof e=="string"&&e.search(s)==-1){this.on_status({status:n.CONNECTED,errorCode:r.ALREADY_CONNECTED});return}t.errorCode==r.NO_ERROR&&t.on_status({status:n.CONNECTING,errorCode:r.NO_ERROR}),i=function(){t.addListeners(),t.socket.emit("hConnect",{publisher:t.publisher,password:t.password,serverHost:t.opts.serverHost,serverPort:t.opts.serverPort})},this.connect_timeout=setTimeout(function(){t.on_status.call(t,{status:n.CONNECTING,errorCode:r.CONN_TIMEOUT})},t.opts.timeout*1e3);if(!this.opts.stress&&this.socket){i();return}this.socket=io.connect(this.opts.endpoint,{"force new connection":!0,"connect timeout":2e3,transports:["websocket","xhr-polling","jsonp-polling","xhr-multipart"]}),this.socket.on("connect",i),this.socket.on("error",function(){t.on_status({status:n.DISCONNECTED,errorCode:r.TECH_ERROR})})},i.prototype.addListeners=function(){var e=this,t=["hStatus","hMessage","hResult","hCommand","attrs"];for(var n=0;n<t.length;n++)this.socket.removeAllListeners(t[n]);this.socket.on("hStatus",e.on_status.bind(e)),this.socket.on("hMessage",function(t){e.callback("hMessage",t)}),this.socket.once("attrs",function(e){})},i.prototype.disconnect=function(){if(this.status==n.DISCONNECTED||this.status==n.DISCONNECTING){this.socket&&this.socket.disconnect();return}this.on_status({status:n.DISCONNECTING,errorCode:r.NO_ERROR}),clearTimeout(this.connect_timeout),this.socket&&this.socket.disconnect(),this.on_status({status:n.DISCONNECTED,errorCode:r.NO_ERROR})},i.prototype.sendhMessage=function(e){this.socket.emit("hMessage",e)},i.prototype.on_status=function(e){if(e){this.status=e.status,this.errorCode=e.errorCode,this.callback("hStatus",e);if(e.errorCode==r.NO_ERROR&&e.status==n.CONNECTED){var t=this;clearTimeout(this.connect_timeout),this.retryIntervals=this.opts.retryIntervals}else if(e.errorCode!=r.NO_ERROR){clearTimeout(this.connect_timeout);if(e.errorCode==r.AUTH_FAILED||e.errorCode==r.ALREADY_CONNECTED)return;var i=this.retryIntervals.length==1?this.retryIntervals[0]:this.retryIntervals.pop();setTimeout(this.connect.bind(this),i*1e3)}}},{hSessionSocketIO:i}}),define("lib/options",[],function(){function e(e){return{serverHost:e.serverHost||"",serverPort:e.serverPort||5222,hServer:e.hServer||"hnode",retryIntervals:e.retryIntervals||[600,300,60,30,10,2],timeout:e.timeout||15,transport:e.transport,endpoints:e.endpoints||["http://localhost:5280/http-bind"],stress:e.stress||!1,msgTimeout:e.msgTimeout||3e4}}return{hub_options:e}}),define("hubiquitus",["./lib/transports/socketio/hsession-socketio","./lib/options","./lib/codes"],function(e,t,n){var r=n.statuses,i=n.errors,s=function(){this.onStatus=function(e){},this.onMessage=function(e){},this.msgToBeAnswered={},this.status=r.DISCONNECTED};s.prototype={connect:function(s,o,u){var a=this.status==r.CONNECTED?i.ALREADY_CONNECTED:i.CONN_PROGRESS;if(this.status==r.CONNECTED||this.status==r.CONNECTING){this.onStatus({status:this.status,errorCode:a});return}this.hOptions=t.hub_options(u||{});var f=function(e,t){switch(e){case"hStatus":this.status=t.status,this.onStatus(t);break;case"hMessage":this.onMessageInternal(t)}};if(!this.checkJID(s))return this.onStatus({status:n.statuses.DISCONNECTED,errorCode:n.errors.JID_MALFORMAT});this.domain=this.splitJID(s)[1],this.publisher=s;var l=this.hOptions.endpoints;this.hOptions.endpoint=l[Math.floor(Math.random()*l.length)];switch(this.hOptions.transport){default:this.transport=new e.hSessionSocketIO(s,o,f.bind(this),this.hOptions)}this.transport.connect(s)},onMessageInternal:function(e){var t;e&&e.ref&&typeof e.ref=="string"&&(t=e.ref.split("#")[0]);if(t)var n=this.msgToBeAnswered[t];n?(delete this.msgToBeAnswered[t],n(e)):this.onMessage(e)},disconnect:function(){this.transport?(this.transport.disconnect(),delete this.transport):this.onStatus({status:n.statuses.DISCONNECTED,errorCode:n.errors.NOT_CONNECTED})},subscribe:function(e,t){var n=this.buildCommand(e,"hSubscribe");n.timeout===undefined&&(n.timeout=this.hOptions.msgTimeout),this.send(n,t)},unsubscribe:function(e,t){var n=this.buildCommand(e,"hUnsubscribe");n.timeout===undefined&&(n.timeout=this.hOptions.msgTimeout),this.send(n,t)},send:function(e,t){if(!(e instanceof Object))return t(this.buildResult("Unkonwn","Unknown",n.hResultStatus.MISSING_ATTR,"provided hMessage should be an object"));e.publisher=this.publisher,e.msgid=UUID.generate(),e.published=e.published||new Date,e.sent=new Date;var i=undefined,s=undefined;e.actor?this.status!=r.CONNECTED&&(i=n.hResultStatus.NOT_CONNECTED,s="client not connected, cannot send command"):(i=n.hResultStatus.MISSING_ATTR,s="the actor attribute is missing");if(!i){if(t)if(e.timeout>0){this.msgToBeAnswered[e.msgid]=t;var o=e.timeout,u=this;setInterval(function(){if(u.msgToBeAnswered[e.msgid]){delete u.msgToBeAnswered[e.msgid],e.payload&&typeof e.payload=="object"&&(a=e.payload.cmd),errCode=n.hResultStatus.EXEC_TIMEOUT,errMsg="No response was received within the "+o+" timeout";var r=u.buildResult(e.publisher,e.msgid,errCode,errMsg);t(r)}},o)}else e.timeout=0;else e.timeout=0;this.transport.sendhMessage(e)}else if(t){var a;e.payload&&typeof e.payload=="string"&&(a=e.payload.cmd);var f=e.actor||"Unknown",l=this.buildResult(f,e.msgid,i,s);t(l)}},getSubscriptions:function(e){var t=this.buildCommand(this.hOptions.hServer+"@"+this.domain,"hGetSubscriptions");t.timeout===undefined&&(t.timeout=this.hOptions.msgTimeout),this.send(t,e)},getLastMessages:function(e,t,n){typeof t=="function"&&(n=t,t=undefined);var r=this.buildCommand(e,"hGetLastMessages",{nbLastMsg:t});r.timeout===undefined&&(r.timeout=this.hOptions.msgTimeout),this.send(r,n)},getThread:function(e,t,n){var r=this.buildCommand(e,"hGetThread",{convid:t});r.timeout===undefined&&(r.timeout=this.hOptions.msgTimeout),this.send(r,n)},getThreads:function(e,t,n){var r=this.buildCommand(e,"hGetThreads",{status:t});r.timeout===undefined&&(r.timeout=this.hOptions.msgTimeout),this.send(r,n)},setFilter:function(e,t){var n=this.buildCommand(this.hOptions.hServer+"@"+this.domain,"hSetFilter",e);n.timeout===undefined&&(n.timeout=this.hOptions.msgTimeout),this.send(n,t)},getRelevantMessages:function(e,t){var n=this.buildCommand(e,"hRelevantMessages");n.timeout===undefined&&(n.timeout=this.hOptions.msgTimeout),this.send(n,t)},buildCommand:function(e,t,n,r){n=n||{},r=r||{};if(!t)throw new Error("missing cmd");var i={cmd:t,params:n};return this.buildMessage(e,"hCommand",i,r)},buildResult:function(e,t,n,r,i){i=i||{};if(n===undefined||n===null)throw new Error("missing status");if(!t)throw new Error("missing ref");var s={status:n,result:r};return i.ref=t,this.buildMessage(e,"hResult",s,i)},buildMessage:function(e,t,n,r){r=r||{};if(!e)throw new Error("missing actor");var i={};i.actor=e,r.ref&&(i.ref=r.ref),r.convid&&(i.convid=r.convid),t&&(i.type=t),r.priority&&(i.priority=r.priority),r.relevance&&(i.relevance=r.relevance);if(r.persistent!==null||r.persistent!==undefined)i.persistent=r.persistent;return r.location&&(i.location=r.location),r.author&&(i.author=r.author),r.published&&(i.published=r.published),r.headers&&(i.headers=r.headers),n&&(i.payload=n),r.timeout&&(i.timeout=r.timeout),i},buildMeasure:function(e,t,n,r){if(!t)throw new Error("missing value");if(!n)throw new Error("missing unit");return this.buildMessage(e,"hMeasure",{unit:n,value:t},r)},buildAlert:function(e,t,n){if(!t)throw new Error("missing alert");return this.buildMessage(e,"hAlert",{alert:t},n)},buildAck:function(e,t,n,r){if(!n)throw new Error("missing ack");if(!t)throw new Error("missing ref");if(!/recv|read/i.test(n))throw new Error('ack does not match "recv" or "read"');return typeof r!="object"&&(r={}),r.ref=t,this.buildMessage(e,"hAck",{ack:n},r)},buildConvState:function(e,t,n,r){if(!t)throw new Error("missing convid");if(!n)throw new Error("missing status");return r||(r={}),r.convid=t,this.buildMessage(e,"hConvState",{status:n},r)},checkJID:function(e){return(new RegExp("^(?:([^@/<>'\"]+)@)([^@/<>'\"]+)(?:/([^/<>'\"]*))?$")).test(e)},splitJID:function(e){return e.match(new RegExp("^(?:([^@/<>'\"]+)@)([^@/<>'\"]+)(?:/([^/<>'\"]*))?$")).splice(1,3)},errors:n.errors,statuses:n.statuses,hResultStatus:n.hResultStatus},typeof module!="undefined"&&module.exports?(exports.hClient=new s,exports.HubiquitusClient=s,exports.statuses=n.statuses,exports.hResultStatus=n.hResultStatus):hClient=new s}),UUID.generate=function(){var e=UUID._gri,t=UUID._ha;return t(e(32),8)+"-"+t(e(16),4)+"-"+t(16384|e(12),4)+"-"+t(32768|e(14),4)+"-"+t(e(48),12)},UUID._gri=function(e){return 0>e?NaN:30>=e?0|Math.random()*(1<<e):53>=e?(0|1073741824*Math.random())+1073741824*(0|Math.random()*(1<<e-30)):NaN},UUID._ha=function(e,t){for(var n=e.toString(16),r=t-n.length,i="0";0<r;r>>>=1,i+=i)r&1&&(n=i+n);return n}